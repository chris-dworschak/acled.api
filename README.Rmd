---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```



# Automated Retrieval of ACLED Conflict Event Data

<!-- badges: start -->
[![CRAN status](https://www.r-pkg.org/badges/version-last-release/acled.api)](https://CRAN.R-project.org/package=acled.api)
[![Lifecycle: stable](https://img.shields.io/badge/lifecycle-stable-brightgreen.svg)](https://www.tidyverse.org/lifecycle/#stable)
[![Travis build status](https://travis-ci.com/chris-dworschak/acled.api.svg?branch=master)](https://travis-ci.com/chris-dworschak/acled.api)
[![CRANlogs](http://cranlogs.r-pkg.org/badges/grand-total/acled.api)](https://CRAN.R-project.org/package=acled.api)
<!-- badges: end -->

This small package provides functionality to access and manage the application programming interface (API) of the [Armed Conflict Location & Event Data Project (ACLED)](https://acleddata.com/). The function `acled.api()` makes it easy to retrieve a user-defined sample (or all of the available data) of ACLED, enabling a seamless integration of regular data updates into the research work flow. 

When using this package, you acknowledge that you have read ACLED's terms and conditions of use, and that you agree with their attribution requirements.


```{r downloads, echo=FALSE, dpi=150, out.width=525, out.height=404, fig.align="center"}
response <- httr::GET("https://cranlogs.r-pkg.org/downloads/daily/2020-10-23:2025-10-29/acled.api")
json.content <- jsonlite::fromJSON( httr::content(response, "text", encoding = 'UTF-8'), simplifyVector = FALSE)
acled.matrix <- matrix( unlist(json.content[1L][[1]]$downloads),
                          byrow = T,
                          nrow = length( json.content[1L][[1]]$downloads ))

acled.data <- data.frame(acled.matrix, stringsAsFactors = FALSE)
names(acled.data) <- c("date", "downloads")
acled.data[,2] <- as.numeric(acled.data[,2])
x.vector <- 1:length(acled.data[,1])
acled.data$cum.downloads <- acled.data$downloads
for(i in 2:length(x.vector)){acled.data[i,3] <- acled.data[i,3]+acled.data[i-1,3]}

barplot(acled.data$downloads, col = "white", axes=FALSE, 
        ylab = "Number of downloads", main = "Daily number of CRAN package downloads")
text(cex=0.9, x=(x.vector-0.5)*1.2, y=-max(acled.data$downloads)/7, acled.data$date, xpd=TRUE, srt=45)
axis(2,
     at = round( seq(from = 1, to = max(acled.data$downloads), length=5) ),
     las = 2
     )

# plot(x.vector, acled.data$cum.downloads, type="l", axes=FALSE,
#      xlab = "Days", ylab = "Cumulative number of downloads", main = "CRAN package downloads")
# axis(1, 
#      at = x.vector, 
#      labels = c(min(acled.data$date), 
#                 rep("", length(2:round( length(x.vector)/2 ))-1 ),
#                 acled.data$date[round( length(x.vector)/2 )],
#                 rep("", length( (round( length(x.vector)/2 )+1):(length(x.vector)-1) ) ),
#                 max(acled.data$date) ) 
#      )
# axis(2, 
#      at = round( seq(from = 1, to = max(acled.data$cum.downloads), length=5) ), 
#      las = 2
#      )

```






### Installation

You can install the latest release version of acled.api from [CRAN](https://CRAN.R-project.org) with: 

``` r
install.packages("acled.api")
```

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("chris-dworschak/acled.api") # downloads and installs the package
```


### Example

Using `acled.api` is straight forward. To download data on, for example, all ACLED conflict events in Europe and Central America that happened between June 2019 and July 2020, you can supply:


```{r example}
library(acled.api) # loads the package

my.data.frame <- acled.api( # stores an ACLED sample in object my.data.frame
  email.address = Sys.getenv("EMAIL_ADDRESS"),
  access.key = Sys.getenv("ACCESS_KEY"),
  region = c("Southern Asia", "Central America"), 
  start.date = "2019-06-01", 
  end.date = "2020-07-31")

my.data.frame[1:3,] # returns the first three observations of the ACLED sample
```

